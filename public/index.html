<!DOCTYPE html>
<html>
<head>
    <title>Simple Simon</title>
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <style>
        h2{
            text-align: center;
        }
        .container{
            width: 350px;
            border: solid black 4px;
            background-color: #1a1a1a;
        }
        .square{
            height: 150px;
            width: 150px;
            border: solid black 1px;
            box-shadow: 5px 5px 5px #404040;
        }
        #red{
            opacity: .5;
            background-color: red;
            margin: 10px;
        }
        #blue{
            opacity: .5;
            background-color: blue;
            margin: 10px;
        }
        #green{
            opacity: .5;
            background-color: green;
            margin: 10px;
        }
        #yellow{
            opacity: .5;
            background-color: yellow;
            margin: 10px;
        }
        #button{
            text-align: center;
            margin-top: 10px;
        }

    </style>
</head>
<body>
<div class="container">
<div class="row">
<div class="square col-xs-6 col-sm-6 col-md-3" id="red"></div>
<div class="square col-xs-6 col-sm-6 col-md-3" id="blue"></div>
</div>
<div class="row">
<div class="square col-xs-6 col-sm-6 col-md-3" id="green"></div>
<div class="square col-xs-6 col-sm-6 col-md-3" id="yellow"></div>
</div>
</div>
<h2></h2>
<div id="button">
    <button>Start Game</button>
</div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>
(function() {

var random = 0;
var max = 1;
var sequence = [];
var count = 0;

function randomColorPicker(){
    for(var i = 0; i < max; i++){
        random = Math.floor(Math.random() * $('.square').length);
        sequence.push(random);
        console.log(random);
    }
   
    var intervalId = setInterval(function () {
    if (count >= sequence.length){
        clearInterval(intervalId);
        count = 0;
        patternPosition = 0;
        $(".square").on("click", onClick);
        console.log('All done');
    } else {

        $('.square').eq(sequence[count]).css("opacity","1");
        $(".square").off("click", onClick);
        count++;
        var timeoutId = setTimeout(function ()
        {
          $(".square").removeAttr('style');
        }, 500);

    } 
    }, 800);
        console.log(sequence);
    }  

    var round = 1;
    $("#button").click(function (){
        randomColorPicker();
        $("h2").html("Round # "+ round);

        $("#button").hide();
    });

    var patternPosition = 0;
    var userInput; //user input 
    $(".square").click(onClick);
    function onClick (e){       // allows opacity to be changed when clicked
        $(this).css("opacity", "1");
        if (this.id =="red"){
            userInput = 0;
        }
        if (this.id =="blue"){
            userInput = 1;
        }
        if (this.id =="green"){
            userInput = 2;
        }
        if (this.id =="yellow"){
            userInput = 3;
        }
        console.log(userInput);
        $(this).css("box-shadow","none");
        if (userInput == sequence[patternPosition]){        //if correct color picked in right order, moves to next color in array
            console.log("correct");
            patternPosition++;
            if( patternPosition == sequence.length){
                round++;
                
                randomColorPicker();
                $("h2").html("Round # "+ round)
           }
        } else {    
            sequence = [];      //if wrong then start game over
            console.log("Start Over");
            $("#button").show();
            $("h2").html("Start New Game");
            round = 1;
        }
        var timeoutId = setTimeout(function ()
        {
          $(".square").removeAttr('style');
        }, 100);
    };


})();
</script>
</body>
</html>